<script type="text/javascript">
  RED.nodes.registerType('Niagara Obix Connector', {
    category: 'config',
    credentials: {
      username: { type: 'text' },
      password: { type: 'password' },
    },
    defaults: {
      displayName: { value: '' },
      useCredentialsFromSettings: { value: false },
      credentialsKey: { value: '' },
      host: { value: 'localhost' },
      protocol: { value: 'https' },
      port: { value: '443' },
    },
    label: function () {
      return this.displayName || (this.host && this.port ? `${this.host}:${this.port}` : this.username) || 'Obix Connector';
    },
    oneditprepare: function () {
      $('#node-config-input-useCredentialsFromSettings').change(function () {
        if ($(this).prop('checked')) {
          $('.credentials-row').hide();
          $('.credentials-key-row').show();
        } else {
          $('.credentials-row').show();
          $('.credentials-key-row').hide();
        }
      });
    },
  });
</script>

<script type="text/html" data-template-name="Niagara Obix Connector">
  <div class="form-row">
    <label for="node-config-input-displayName"><i class="fa fa-tag"></i> Name</label>
    <input type="text" id="node-config-input-displayName" placeholder="ex. Niagara Station 1" />
  </div>
  <hr />
  <div class="form-row">
    <label for="node-config-input-useCredentialsFromSettings"><i class="fa fa-gear"></i> Use Settings Credentials</label>
    <input type="checkbox" id="node-config-input-useCredentialsFromSettings" style="display: inline-block; width: 22px; vertical-align: super;" />
  </div>
  <div class="form-row credentials-row">
    <label for="node-config-input-username"><i class="fa fa-user"></i> Username</label>
    <input type="text" id="node-config-input-username" placeholder="Obix user" />
  </div>
  <div class="form-row credentials-row">
    <label for="node-config-input-password"><i class="fa fa-lock"></i> Password</label>
    <input type="password" id="node-config-input-password" placeholder="Obix user password" />
  </div>
  <div class="form-row credentials-key-row">
    <label for="node-config-input-credentialsKey"><i class="fa fa-key"></i> Key</label>
    <input type="text" id="node-config-input-credentialsKey" placeholder="ex. station1Credentials" />
  </div>
  <hr />
  <div class="form-row">
    <label for="node-config-input-host"><i class="fa fa-globe"></i> IP Address</label>
    <input type="text" id="node-config-input-host" placeholder="ex. 192.168.1.10" />
  </div>
  <div class="form-row">
    <label for="node-config-input-protocol"><i class="fa fa-shield"></i> Protocol</label>
    <select name="node-config-input-protocol" id="node-config-input-protocol">
      <option value="https">HTTPS</option>
      <option value="http">HTTP</option>
    </select>
  </div>
  <div class="form-row">
    <label for="node-config-input-port"><i class="fa fa-shield"></i> Port</label>
    <input type="number" id="node-config-input-port" placeholder="ex. 443" />
  </div>
  <div class="form-tips">
    <b>Tip:</b> The ObixNetwork Driver must be under the Drivers in the Niagara Tree and include a user with access through HTTPBasic, as well as
    proper privileges. Check the github README for more details
  </div>
</script>

<!-- Help -->
<script type="text/html" data-help-name="Niagara Obix Connector">
  <h3>Details</h3>
  <div>Details about this node can be found <a href="https://github.com/adamzman/NodeRed_Niagara_Obix_Node/tree/master/Connector">here</a></div>
</script>
